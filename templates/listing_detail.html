<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Catalogue</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/listing_detail_style.css' %}">

</head>
<body>
    {% include "_navigation.html" %}

    {% for msg in messages %}
            {{ msg }}
    {% endfor %}
    <div class="property-card">

        <div class="image-and-status">
            <!-- IMAGE SLIDESHOW -->
            <div class="custom-carousel">
                <div class="carousel-images">
                    <img src="/static/{{ listing.thumbnail }}" class="carousel-item" alt="Property Image">
                    {% for image in images %}
                        {% if not image.thumbnail %}
                            <img src="/static/{{ image.image_url }}" class="carousel-item" alt="Property Image">
                        {% endif %}
                    {% endfor %}
                </div>
                <button class="carousel-prev" onclick="moveSlide(-1)">&#10094;</button>
                <button class="carousel-next" onclick="moveSlide(1)">&#10095;</button>
            </div>


            {% if listing.status == "AVAILABLE" %}
                <p><strong>Listing status: </strong> <span class="status available">{{ listing.status }}</span></p>
            {% elif listing.status == "PENDING" %}
                <p><strong>Listing status: </strong> <span class="status pending">{{ listing.status }}</span></p>
            {% elif listing.status == "SOLD" %}
                <p><strong>Listing status: </strong> <span class="status sold">{{ listing.status }}</span></p>
            {% endif %}

        </div>


        <!-- LISTING INFO -->
        <div class="property-details">
            <p class="property-address"><strong>Address: </strong>{{listing.street}} {{listing.number}}</p>
            <p class="property-address"><strong>City: </strong>{{listing.city}}</p>
            <p class="property-address"><strong>Postal Code: </strong>{{listing.zip}}</p>
            <p><strong>Description: </strong>{{ listing.description }}</p>
            <p><strong>Type of property: </strong>{{ listing.type }}</p>
            <p><strong>Listing price: </strong>${{ listing.price }}</p>
            <p><strong>Listing date: </strong>{{ listing.listing_date }}</p>
            <p><strong>Listing status: </strong>{{ listing.status }}</p>
            <div class="seller">
                <label for="seller-link"><strong>Seller: </strong></label>
                <div class="seller-card">
                    <img src="/static/{{ seller.profile_image_url }}" alt="Seller image">
                    <div class="seller-info">
                        <p class="seller-name">{{seller.name}}, {{seller.seller_type}} </p>
                        <a href="/sellers/{{seller.id}}/"> See more </a>
                    </div>
                </div>
            </div>

            <label id="toggle-info" style="cursor: pointer;"><strong>Additional information</strong></label>

            <div class="additional-info" id="additional-info">
                    <p>Total number of rooms: {{ listing.num_of_rooms }}</p>
                    <p>Number of bedrooms: {{ listing.num_of_bedrooms }}</p>
                    <p>Number of bathrooms: {{ listing.num_of_bathrooms }}</p>
                <p>Number of square meters: {{ listing.num_of_sq_m }}</p>
            </div>
        </div>

    </div>

    <div class="buttons">
        <button type="button" onclick="window.history.back()">Go back</button>
        {% autoescape off %}
            {{ button }}
        {% endautoescape %}
        
    </div>

    {% include "_footer.html" %}
    {% load static %}
    <script src="{% static 'js/listing_detail.js' %}">

        document.querySelector('.ToCreateOffer-button').addEventListener('click', function () {
            window.location.href = `/offers/${this.dataset.id}/create_offer`;
        });
        function redirectToUpdate(offerID) {
            window.location.href = `/offers/update_offer/${offerID}`;
        }

    </script>
</body>

</html>

